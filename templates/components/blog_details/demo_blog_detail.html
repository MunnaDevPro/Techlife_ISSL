{% extends 'base.html' %} {% load static %} {% block content %}
<header class="max-w-7xl mx-auto pr-16 pl-16 mt-4">
    <i class="fa-solid fa-house"></i>
    <span class="text-sm text-gray-600 pl-2">Bangladesh</span>
    <span class="text-sm text-gray-600 mx-1">/</span>
    <a class="text-sm text-gray-600 hover:text-blue-600 cursor-pointer">{{ blog_detail.category.name }}</a>
</header>

<div class="max-w-7xl mx-auto pr-16 pl-16">
    <div class="flex flex-col md:flex-row md:space-x-8">
        <main class="w-full md:w-2/3 blog-content-area">
            <div class="details">
                <!-- Title -->
                <h1 id="blog-title" class="font-inter pt-2 text-2xl sm:text-3xl font-serif-custom font-extrabold text-gray-900 leading-tight">{{ blog_detail.title }}</h1>

                <!-- Social icons area -->
                <div class="flex justify-between items-center font-inter mt-3 border-t border-gray-200 pt-2">
                    <div class="flex items-center space-x-3 text-sm text-gray-600">
                        <span>
                            <i class="fa-solid fa-user pr-2"></i>
                            by {{ blog_detail.author.first_name }} {{ blog_detail.author.last_name }}
                        </span>
                        <span>
                            <i class="fa-solid fa-eye mr-1 pt-[5px]"></i>
                            {{ blog_detail.views }}
                        </span>
                    </div>

                    <!-- Social Icons -->
                    <div class="flex items-center gap-1.5">
                        <div class="flex w-8 h-8 border rounded-full border-[#1877F2] justify-center items-center hover:bg-[#1877F2] hover:text-white">
                            <a href="#" class="text-[#1877F2] hover:text-white"><i class="fa-brands fa-facebook-f"></i></a>
                        </div>
                        <div class="flex w-8 h-8 border rounded-full border-[#1DA1F2] justify-center items-center hover:bg-[#1DA1F2] hover:text-white">
                            <a href="#" class="text-[#1DA1F2] hover:text-white"><i class="fa-brands fa-x-twitter"></i></a>
                        </div>
                        <div class="flex w-8 h-8 border rounded-full border-[#0A66C2] justify-center items-center hover:bg-[#0A66C2] hover:text-white">
                            <a href="#" class="text-[#0A66C2] hover:text-white"><i class="fa-brands fa-linkedin-in"></i></a>
                        </div>
                        <div class="flex w-8 h-8 border rounded-full border-[#25D366] justify-center items-center hover:bg-[#25D366] hover:text-white">
                            <a href="#" class="text-[#25D366] hover:text-white"><i class="fa-brands fa-whatsapp"></i></a>
                        </div>
                        <div class="flex w-8 h-8 border rounded-full border-gray-400 justify-center items-center hover:bg-gray-500 hover:text-white">
                            <a href="#" class="text-gray-500 hover:text-white"><i class="fa-solid fa-print"></i></a>
                        </div>
                    </div>
                </div>

                <!-- Blog Image -->
                <div class="relative mt-3">
                    <img class="w-full h-auto object-cover" src="{{ blog_detail.featured_image_url }}" alt="AI chip" />
                </div>

                <!-- Author + Listen -->
                <div class="mt-2">
                    <span class="text-blue-600 font-extrabold">
                        TL
                        <span class="text-gray-900 ml-1 font-bold">Techlife Report</span>
                    </span>
                </div>
                <div class="flex items-center justify-between text-sm text-gray-600 mt-1">
                    <!-- publis date -->
                    <div>
                        <span class="mr-4">Publish : {{ blog_detail.created_at|date:"d, M Y" }}</span>
                        |
                        <span>Update : {{ blog_detail.updated_at|date:"d, M Y" }}</span>
                    </div>

                    <!-- Audio Control -->
                    <div class="flex items-center border border-gray-400 rounded-full px-3 py-1 cursor-pointer">
                        <div class="audio-controls flex items-center gap-2">
                            <button id="main-audio-btn" class="flex items-center gap-1" title="Listen">
                                <!-- <i id="icon-display" class="fa-solid fa-play"></i> -->
                                <span id="icon-display" class="text-gray-700">‚ñ∂Ô∏è</span>
                                <span>Audio</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Blog Description -->
                <div id="blog-description" class="article-body mt-6 space-y-5 text-gray-800 font-serif-custom">
                    <p>{{ blog_detail.description|linebreaksbr }}</p>
                </div>

                {% comment %} add section {% endcomment %}
                <div class="flex justify-center items-center bg-gray-200 w-full mx-auto h-[100px] mt-6">
                    <p class="text-gray-500">Google adds (size not define)</p>
                </div>

                <!-- Comment Section -->
                <section id="comments" class="mt-12 border-t border-gray-200 pt-8">
                    <!-- Header -->
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-bold text-gray-800">Comments ({{ comments.count }})</h2>

                        <!-- Sort dropdown -->
                        <div class="relative">
                            <select id="sort-comments" class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-1 focus:ring-blue-500 focus:outline-none cursor-pointer">
                                <option value="newest" selected><span class="cursor-pointer">Newest</span></option>
                                <option value="oldest"><span class="cursor-pointer">Oldest</span></option>
                                <option value="oldest"><span class="cursor-pointer">Recently</span></option>
                            </select>
                        </div>
                    </div>

                    <!-- Comment Form -->
                    <div class="flex gap-3 mb-8">
                        <!-- User Icon -->
                        <div class="flex-shrink-0">
                            <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="User Avatar" class="w-10 h-10 rounded-full border" />
                        </div>

                        <!-- Form -->
                        <form method="" class="flex-1 bg-gray-50 border border-gray-300 rounded-xl p-4 shadow-sm">
                            {% csrf_token %} {% comment %}
                            <div class="flex gap-3 mb-3">
                                <input type="text" name="name" placeholder="Your name" class="w-1/2 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:outline-none" />
                                <input type="email" name="email" placeholder="Your email" class="w-1/2 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:outline-none" />
                            </div>
                            {% endcomment %}
                            <textarea id="messageInput" name="content" rows="2" placeholder="Write your comment..." class="w-full rounded-lg px-3 py-2 focus:ring-1 focus:ring-blue-400 focus:outline-none resize-y"></textarea>

                            <div class="flex justify-between items-center mt-3">
                                <div class="relative flex items-center gap-3 text-gray-500 text-sm">
                                    <!-- Emoji Button -->
                                    <button type="button" id="emojiBtn" title="Add emoji" class="hover:text-blue-600">
                                        <i class="fa-regular fa-face-smile text-xl"></i>
                                    </button>

                                    <!-- File Button -->
                                    <button type="button" id="fileBtn" title="Attach file" class="hover:text-blue-600">
                                        <i class="fa-solid fa-paperclip text-xl"></i>
                                    </button>

                                    <!-- Hidden File Input -->
                                    <input type="file" id="hiddenFileInput" class="hidden" />

                                    <!-- Emoji Picker Container -->
                                    <div id="emojiPicker" class="absolute bottom-14 left-10 hidden bg-white border rounded-xl p-2 shadow-md z-50"></div>
                                </div>

                                <button type="submit" class="bg-blue-500 text-white px-5 py-2 rounded-lg hover:bg-blue-600 transition-all duration-200 font-inter">Comment</button>
                            </div>
                        </form>
                    </div>

                    <!-- Comment List -->
                    <div id="comment-list" class="space-y-5">
                        {% for comment in comments %}
                        <div class="flex gap-3 bg-white border border-gray-200 rounded-xl p-4 shadow-sm hover:shadow-md transition-all">
                            <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="User" class="w-10 h-10 rounded-full" />
                            <div class="flex-1">
                                <div class="flex justify-between items-center mb-1">
                                    <h3 class="font-semibold text-gray-800">{{ comment.name }}</h3>
                                    <span class="text-xs text-gray-500">{{ comment.created_at|date:"d M Y, h:i A" }}</span>
                                </div>
                                <p class="text-gray-700 text-sm">{{ comment.content }}</p>
                            </div>
                        </div>
                        {% empty %}
                        <p class="text-gray-500 italic">No comments yet!</p>
                        {% endfor %}
                    </div>
                </section>
            </div>
        </main>

        <div class="w-[1px] h-auto bg-gray-200">
        </div>

        <aside class="w-full md:w-1/3 mt-8 md:mt-0 space-y-6">
            <div class="bg-gray-200 p-6 flex items-center justify-center h-32">
                <div class="text-center">
                    <img src="https://via.placeholder.com/80x40/FFFFFF/2d3748?text=BSRM" alt="TECHLIFE" class="mx-auto h-10" />
                    <p class="text-sm font-bold text-gray-700 mt-1">ADD</p>
                </div>
            </div>

            <!-- <div class="bg-gray-900 p-4 relative overflow-hidden h-72">
                <img src="https://via.placeholder.com/300x280?text=Walton+Ad+Image" alt="Walton Ad" class="absolute inset-0 w-full h-full object-cover opacity-70">
                <div class="relative text-white z-10 p-2">
                    <p class="text-lg font-bold">WALTON</p>
                    <p class="text-3xl font-extrabold leading-none">Smart Fridge</p>
                    <p class="mt-4 bg-red-600 text-white px-4 py-2 text-xs font-semibold inline-block rounded hover:bg-red-700">See Details</p>
                </div>
                <img src="https://via.placeholder.com/100x200?text=Model" alt="Model" class="absolute bottom-0 right-0 h-4/5 object-cover z-20">
            </div> -->

            <div class="mt-5">
                <div>
                    <h2 class="text-[22px] font-bold text-gray-900 mb-1 font-inter">Related News</h2>
                </div>
                <div class="flex flex-col mb-4">
                    <div class="absolute w-[85px] h-[2px] bg-blue-600"></div>
                    <div class="w-full h-[2px] bg-gray-300"></div>
                </div>

                

                <div class="flex items-start mb-4 border-b pb-3 relative group">
                    <!-- Image wrapper with rounded corner -->
                    <div class="w-[200px] h-[70px] overflow-hidden rounded-md transform transition-transform duration-300 ease-out group-hover:-translate-y-1 group-hover:scale-[1]">
                        <img class="w-full h-full object-cover" src="https://www.techlife.com.bd/uploads/news/847985_when-human-intelligence-beats-the-machine-%E2%80%93-a-historic-moment-in-competitive-programming.jpg" alt="News Image 1" />
                    </div>
                    <div>
                        <p class="text-sm text-gray-800 hover:text-blue-600 cursor-pointer line-clamp-2 ml-3">When Human Intelligence Beats the Machine ‚Äì A Historic Moment in Competitive Programming
                        </p>
                        <span class="text-[11px] text-gray-800 ml-3">21, OCT 2024</span>
                    </div>
                </div>

                <div class="flex items-start mb-4 border-b pb-3 relative group">
                    <!-- Image wrapper with rounded corner -->
                    <div class="w-[200px] h-[70px] overflow-hidden rounded-md transform transition-transform duration-300 ease-out group-hover:-translate-y-1 group-hover:scale-[1]">
                        <img class="w-full h-full object-cover" src="https://www.techlife.com.bd/uploads/news/847985_when-human-intelligence-beats-the-machine-%E2%80%93-a-historic-moment-in-competitive-programming.jpg" alt="News Image 1" />
                    </div>
                    <div>
                        <p class="text-sm text-gray-800 hover:text-blue-600 cursor-pointer line-clamp-2 ml-3">When Human Intelligence Beats the Machine ‚Äì A Historic Moment in Competitive Programming
                        </p>
                        <span class="text-[11px] text-gray-800 ml-3">21, OCT 2024</span>
                    </div>
                </div>

                <div class="flex items-start mb-4 border-b pb-3 relative group">
                    <!-- Image wrapper with rounded corner -->
                    <div class="w-[200px] h-[70px] overflow-hidden rounded-md transform transition-transform duration-300 ease-out group-hover:-translate-y-1 group-hover:scale-[1]">
                        <img class="w-full h-full object-cover" src="https://www.techlife.com.bd/uploads/news/847985_when-human-intelligence-beats-the-machine-%E2%80%93-a-historic-moment-in-competitive-programming.jpg" alt="News Image 1" />
                    </div>
                    <div>
                        <p class="text-sm text-gray-800 hover:text-blue-600 cursor-pointer line-clamp-2 ml-3">When Human Intelligence Beats the Machine ‚Äì A Historic Moment in Competitive Programming
                        </p>
                        <span class="text-[11px] text-gray-800 ml-3">21, OCT 2024</span>
                    </div>
                </div>

                <div class="flex items-start mb-4 border-b pb-3 relative group">
                    <!-- Image wrapper with rounded corner -->
                    <div class="w-[200px] h-[70px] overflow-hidden rounded-md transform transition-transform duration-300 ease-out group-hover:-translate-y-1 group-hover:scale-[1]">
                        <img class="w-full h-full object-cover" src="https://www.techlife.com.bd/uploads/news/847985_when-human-intelligence-beats-the-machine-%E2%80%93-a-historic-moment-in-competitive-programming.jpg" alt="News Image 1" />
                    </div>
                    <div>
                        <p class="text-sm text-gray-800 hover:text-blue-600 cursor-pointer line-clamp-2 ml-3">When Human Intelligence Beats the Machine ‚Äì A Historic Moment in Competitive Programming
                        </p>
                        <span class="text-[11px] text-gray-800 ml-3">21, OCT 2024</span>
                    </div>
                </div>
            </div>
        </aside>
    </div>
</div>

<!-- audio control -->
<script>
    let speech = null;
    // ‡¶®‡¶§‡ßÅ‡¶®: ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶è‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡¶ü‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ
    const titleElement = document.getElementById('blog-title');
    const descriptionElement = document.getElementById('blog-description');
    const mainAudioBtn = document.getElementById('main-audio-btn');
    const stopBtn = document.getElementById('stop-btn');
    const iconDisplay = document.getElementById('icon-display');
    const synth = window.speechSynthesis;

    // Button State ‡¶è‡¶¨‡¶Ç Icon Update Function (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á ‡¶•‡¶æ‡¶ï‡¶¨‡ßá)
    function updateUI(isSpeaking, isPaused) {
        if (isSpeaking) {
            if (isPaused) {
                iconDisplay.textContent = '‚ñ∂Ô∏è';
                mainAudioBtn.title = 'Resume';
            } else {
                iconDisplay.textContent = '‚è∏Ô∏è';
                mainAudioBtn.title = 'Pause';
            }
            stopBtn.disabled = false;
        } else {
            iconDisplay.textContent = '‚ñ∂Ô∏è';
            mainAudioBtn.title = 'Listen';
            stopBtn.disabled = true;
        }
    }

    // Main Button Click Event
    mainAudioBtn.addEventListener('click', () => {
        // A. ‡¶Ø‡¶¶‡¶ø Pause ‡¶ï‡¶∞‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá Resume ‡¶ï‡¶∞‡ßã
        if (synth.paused) {
            synth.resume();
            updateUI(true, false);
            return;
        }

        // B. ‡¶Ø‡¶¶‡¶ø ‡¶ï‡¶•‡¶æ ‡¶¨‡¶≤‡¶õ‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá Pause ‡¶ï‡¶∞‡ßã
        if (synth.speaking) {
            synth.pause();
            updateUI(true, true);
            return;
        }

        // C. ‡¶®‡¶§‡ßÅ‡¶®: ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶Ü‡¶®‡¶æ
        const titleText = titleElement ? titleElement.textContent : '';
        const descriptionText = descriptionElement ? descriptionElement.textContent : '';

        // ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶ø‡¶∞‡¶æ‡¶Æ‡¶ö‡¶ø‡¶π‡ßç‡¶® (‡¶Ø‡ßá‡¶Æ‡¶® ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ö‡ßç‡¶õ‡ßá‡¶¶ ‡¶¨‡¶æ ‡¶ï‡ßã‡¶≤‡¶®) ‡¶è‡¶¨‡¶Ç ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ
        // ‡¶è‡¶§‡ßá ‡¶™‡ßú‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡ßã‡¶ü ‡¶™‡¶ú (‡¶¨‡¶ø‡¶∞‡¶§‡¶ø) ‡¶π‡¶¨‡ßá‡•§
        const textToSpeak = titleText + '. ' + descriptionText;

        // ‡¶Ø‡¶¶‡¶ø ‡¶ï‡ßã‡¶®‡ßã ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶®‡ßá‡¶á
        if (!textToSpeak.trim()) {
            console.warn('No text content found to speak.');
            return;
        }

        // D. ‡¶¨‡¶≤‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßã
        speech = new SpeechSynthesisUtterance(textToSpeak);
        speech.lang = 'bn-BD'; // ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶≠‡¶æ‡¶∑‡¶æ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®

        synth.speak(speech);
        updateUI(true, false);

        // E. ‡¶¨‡¶≤‡¶æ ‡¶∂‡ßá‡¶∑ ‡¶π‡¶≤‡ßá UI ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßã
        speech.onend = () => {
            updateUI(false, false);
        };

        // Error ‡¶π‡¶≤‡ßá
        speech.onerror = (event) => {
            console.error('Speech synthesis error:', event);
            updateUI(false, false);
        };
    });

    // 3. Stop Button Click Event (‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶§‡ßá) (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á ‡¶•‡¶æ‡¶ï‡¶¨‡ßá)
    stopBtn.addEventListener('click', () => {
        if (synth.speaking || synth.paused) {
            synth.cancel();
            updateUI(false, false);
        }
    });

    // Initial state set ‡¶ï‡¶∞‡¶æ
    updateUI(false, false);
</script>

{% comment %} emoji picker of blog comment {% endcomment %}
<script>
    const emojiBtn = document.getElementById('emojiBtn');
    const emojiPicker = document.getElementById('emojiPicker');
    const messageInput = document.getElementById('messageInput');

    // Add emoji picker inside container
    emojiPicker.innerHTML = `<emoji-picker style="width: 300px; height: 350px;"></emoji-picker>`;
    const picker = emojiPicker.querySelector('emoji-picker');

    emojiBtn.addEventListener('click', () => {
        emojiPicker.classList.toggle('hidden');
    });

    picker.addEventListener('emoji-click', (event) => {
        messageInput.value += event.detail.unicode;
    });

    const fileBtn = document.getElementById('fileBtn');
    const hiddenFileInput = document.getElementById('hiddenFileInput');

    fileBtn.addEventListener('click', () => {
        hiddenFileInput.click();
    });

    hiddenFileInput.addEventListener('change', (e) => {
        const fileName = e.target.files[0]?.name;
        if (fileName) alert(`üìé Selected file: ${fileName}`);
    });
</script>

{% endblock content %}
