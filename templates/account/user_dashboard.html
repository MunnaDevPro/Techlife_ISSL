{% extends 'base.html' %}

{% load static %}

{% block title %}
{{ user.first_name }}-Profile || TechLife
{% endblock title %}

{% block content %}

<div class="min-h-screen bg-gray-100 p-6">

  <!-- Row 1: Profile Card -->
  <div class="bg-white rounded-2xl shadow p-6 flex flex-col md:flex-row items-center gap-6 mb-6">
    <div class="flex-shrink-0">
      <img src="{{ user.profile_picture.url|default:'/static/image/default_user.png' }}" 
      alt="{{ user.first_name|slice:'1' }}"
        class="w-24 h-24 rounded-full border-2 border-blue-400 object-cover flex items-center justify-center text-3xl">
    </div>
    <div class="flex-1">
      <h1 class="text-2xl font-bold">
        {{ user.first_name|default:'Name not added' }} {{ user.last_name }}
      </h1>
      <p class="text-gray-500">{{ user.email }}</p>
      <p class="text-gray-500">
        Phone: {{ user.mobile|default:'Not added' }}
      </p>
    </div>
    <button @click="editProfile = !editProfile"
      class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 shadow">Edit Profile</button>
  </div>

  <!-- Row 2: Stats Section -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
    <div class="bg-white rounded-xl shadow p-4 flex flex-col items-center">
      <h3 class="text-gray-500">Posts</h3>
      <p class="text-2xl font-bold">{{ user.blogpost_set.count }}</p>
    </div>
    <div class="bg-white rounded-xl shadow p-4 flex flex-col items-center">
      <h3 class="text-gray-500">Views</h3>
      <p class="text-2xl font-bold">{{ total_views }}</p>
    </div>
    <div class="bg-white rounded-xl shadow p-4 flex flex-col items-center">
      <h3 class="text-gray-500">Likes</h3>
      <p class="text-2xl font-bold">{{ total_likes }}</p>
    </div>
    <div class="bg-white rounded-xl shadow p-4 flex flex-col items-center">
      <h3 class="text-gray-500">Comments</h3>
      <p class="text-2xl font-bold">{{ total_comments }}</p>
    </div>


  </div>

  <!-- Row 3: Latest Blogs + User Info -->
  <div class="flex flex-col lg:flex-row gap-6 mb-6">

    <!-- Latest Blogs -->
    <div class="lg:w-2/3 bg-white rounded-2xl shadow p-6">
      <h2 class="text-xl font-bold mb-4">Latest Blogs</h2>
      <div class="max-h-96 overflow-y-auto">
        <ul class="space-y-4 pr-2">
          {% for blog in user.blogpost_set.all %}
          <li class="flex justify-between items-center p-4 bg-gray-50 rounded-lg hover:bg-blue-50 transition">
            <div>
              <a href="{% url 'blog_details' blog.slug %}" class="font-semibold text-gray-800 hover:text-blue-500">
                {{ blog.title|truncatechars:30 }}
              </a>
              <p class="text-gray-500 text-sm">{{ blog.created_at|date:"M d, Y" }}</p>
            </div>
            <div class="flex flex-col items-end">
              <span class="text-gray-400">{{ blog.views }} views</span>
              <span class="text-gray-400">0 Point</span>
            </div>



          </li>
          {% empty %}
          <p class="text-gray-500">You have no blogs yet.</p>
          {% endfor %}
        </ul>
      </div>
    </div>

    <!-- earning section and badge , point -->
    <section class="lg:w-1/3 bg-white rounded-2xl  p-3">
      <h1 class="text-center text-xl mb-3 font-semibold">Your <span class="font-bold text-blue-500">Progress</span></h1>
      <!-- badge -->
      <div class="p-4 text-center mb-6  border border-dashed  border-gray-400 rounded-2xl">
        {% if badge_level == "Bronze" %}
        <p class="text-sm text-center font-semibold">Bronze</p>
        <p> Bronze </p>

        {% elif badge_level == "Silver" %}
        <p class="text-sm text-center font-semibold">Silver</p>
        <p>Silver </p>

        {% elif badge_level == "Gold" %}
        <p class="text-sm text-center font-semibold">Gold</p>
        <p>Gold </p>

        {% elif badge_level == "Platinum" %}
        <p class="text-sm text-center font-semibold">Platinum</p>
        <p> Platinum </p>

        {% elif badge_level == "Diamond" %}
        <p class="text-sm text-center font-semibold">Diamond</p>
        <p>Diamond </p>

        {% elif badge_level == "Master" %}
        <p class="text-sm text-center font-semibold">Master</p>
        <p> Master </p>

        {% elif badge_level == "Legend" %}
        <p class="text-sm text-center font-semibold">Legend</p>
        <p>Legend </p>

        {% elif badge_level == "Grand Master" %}
        <p class="text-sm text-center font-semibold">Grand Master</p>
        <p>Grand Master </p>

        {% else %}
        <p class="text-sm text-center font-semibold">No Badge</p>
        {% endif %}

      </div>

      <!-- Two Point Boxes -->
      <div class="grid grid-cols-2 gap-4 mb-6  ">
        <div class=" p-4 text-center border border-dashed border-gray-400 rounded-2xl">
          <p class="text-sm font-semibold">{{ post_point }}</p>
          <p class="text-sm font-semibold">Post Point</p>
        </div>
        <div class=" p-4 text-center border border-dashed  border-gray-400 rounded-2xl">
          <p class="text-sm font-semibold">{{ others_point}}</p>
          <p class="text-sm font-semibold">Others Point</p>
        </div>
      </div>

      <!-- Total Point -->
      <div class="p-4 text-center mb-6  border-gray-400 border border-dashed rounded-2xl">
        <p class="text-sm font-semibold">{{ total_point }}</p>
        <p class="text-sm font-bold text-red-500 ">Total Point</p>
      </div>


      <!-- Buttons: Total Earning & Withdraw -->
      <div class="grid grid-cols-2 gap-4 mb-6  ">
        <div class=" p-4 text-center border border-dashed  border-gray-400 rounded-2xl">
          <p class="text-sm font-semibold">0</p>
          <p class="text-sm font-semibold">Eearning</p>
        </div>
        <div class=" p-4 text-center border border-dashed border-gray-400 rounded-2xl">
          <p class="text-sm font-semibold">0</p>
          <p class="text-sm font-semibold">Withdraw</p>
        </div>
      </div>

      <p class="text-red-500 text-sm text-center">*You are not capable for <a class="font-semibold"
          href="#">Monetization</a></p>


    </section>


  </div>

  <!-- Row 4: User Tags -->
  <div class="bg-white rounded-2xl shadow p-6">
    <h2 class="text-xl font-bold mb-4">Your Tags</h2>
    <div class="flex flex-wrap gap-2">
      {% for tag in user.tags.all %}
      <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm">{{ tag.name }}</span>
      {% empty %}
      <span class="text-gray-500">No tags yet</span>
      {% endfor %}
    </div>
  </div>


  <div class=" mt-5 px-2   text-md rounded-md">
    <a href="{% url 'logout' %}">
      <button class="btn btn-error text-white">Logout</button>
    </a>
  </div>



  {% endblock content %}